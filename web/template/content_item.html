{{define "content"}}
  <body>
    <h2>
      Content Info
      <div style="float:right">
        <a href="/">Return!</a>
      </div>
    </h2>
    <table cellspacing="20">
      <tr>
        <th>Item ID</th>
        <th>Item Name</th>
        <th>File Path</th>
        <th>Time Posted</th>
        <th>Author</th>
        <th>Email</th>
      </tr>
      <tr>
        {{$itemID := .Item.ItemID}}
        {{$fileName := .Item.FileName}}
        {{$isPoll := .Item.IsPoll}}
        {{$email := .Item.Email}}
        <td>{{$itemID}}</td>
        <td>{{$fileName}}</a></td>
        {{if $isPoll}}
        <td>n/a</td>
        {{else}}
        <td>{{ .Item.FilePath }}</td>
        {{end}}
        <td>{{ .Item.PostTime }}</td>
        <td>{{ .Item.Fname }} {{ .Item.Lname }}</td>
        <td>{{$email}}</td>
      </tr>
      {{$isMyContent := eq $email .Username}}
      {{if $isMyContent}}
      <form action="/deleteItem" method=POST onsubmit="return verifyDelete({{.Item.ItemID}})">
        <input type="hidden" name="itemID" value="{{.Item.ItemID}}">
        <input type="submit" value="Delete Item" style="background-color: red">
      </form>
      {{end}}
      {{if $isPoll}}
        <tr>
          <th colspan="2" align="left">
            {{$fileName}}
          </th>
        </tr>
        <tr>
          <th align="left">Choice</th>
          <th align="center"># Votes</th>
        </tr>
        {{range .Item.Votes}}
        <tr>
          <td align="left">{{.Choice}}</td>
          <td align="center">{{.Count}}</td>
        </tr>
        {{end}}
        {{if .Logged}}
        <tr>
          <td colspan="2">
            <!-- 
              Javascript needs to be updated to take more generic class names.
              Avoding this problem currently to prevent merge conflicts.
             -->
            <button onclick="openForm({{$fileName}})" id="tag-button-{{$fileName}}">Vote On Poll</button>
            <div class="tag-form-popup" id="tag-form-{{$fileName}}" style="display: none">
            <form action="/addVote" method="POST">
              <input type="hidden" name="itemID" value="{{$itemID}}">
              <input type="text" name="choice" required>
              <input type="submit" value="Vote!">
              <input type="button" onclick="closeForm({{$fileName}})" value="Close">
            </form>
            </div>
          </td>
        </tr>
        {{end}}
      {{end}}
      {{if .Logged}}
      <tr>
        <td colspan="5">
          <button onclick="openForm({{.Item.ItemID}})" id="tag-button-{{.Item.ItemID}}">Tag someone</button>
          <div class="tag-form-popup" id="tag-form-{{.Item.ItemID}}" style="display: none">
            <form action="/addtag?id={{.Item.ItemID}}" method="POST">
              <label for="username">Username:</label>
              <input type="text" name="username" required>
              <input type="submit" value="Tag!">
              <input type="button" onclick="closeForm({{.Item.ItemID}})" value="Close">
            </form>
          </div>
        </td>
      </tr>
      {{range $i := .Removes}}
        {{$owner := $i.OwnerEmail}}
        {{$fgName := $i.FGName}}
        <tr>
          <td colspan="5">
            <form action="/unshare" method="POST">
              <input type="hidden" name="fgName" value="{{$fgName}}">
              <input type="hidden" name="ownerEmail" value="{{$owner}}">
              <input type="hidden" name="itemID" value="{{$itemID}}">
              <input type="submit" value="Unshare from {{$owner}}'s {{$fgName}}">
            </form>
          </td>
        </tr>
      {{end}}
      {{end}}
    </table>
    <h2>Tagged</h2>
    <ul>
      {{ range .TaggedNames }}
      <li>{{ . }}</li>
      {{ else }}
      <p>No Tags Yet!</p>
      {{ end }}
    </ul>
    <h2>Ratings</h2>
    <table cellspacing="20">
    <thead>
      <th>Rating</th>
      <th>Email</th>
      <th>Rate Time</th>
    <thead>
    <tr>
      {{ range .Ratings }}
      <td>{{ .Emoji }}</td>
      <td>{{ .Email }}</td>
      <td>{{ .Rate_time }}</td>
      {{ else }}
      <td colspan="3">No Ratings Yet!</td>
      {{ end }}
    </tr>
    </table>
    <script type="text/javascript">
      function openForm(ID) {
        document.getElementById("tag-form-"+ID).style.display = "block";
        document.getElementById("tag-button-"+ID).style.display = "none";
      }
      function closeForm(ID) {
        document.getElementById("tag-form-"+ID).style.display = "none";
        document.getElementById("tag-button-"+ID).style.display = "block";
      }
      function verifyDelete(ID) {
        return (confirm("Are you sure you want to delete this content item?"))
      }
    </script>
</body>
{{end}}